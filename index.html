<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Vacunas PAI v4.0 - Flujo, Errores y Validaciones</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0056a3;
            --primary-dark: #003d82;
            --secondary-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --gray-color: #6c757d;
            --border-radius: 12px;
            --box-shadow: 0 8px 30px rgba(0, 86, 163, 0.15);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* HEADER */
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            opacity: 0.1;
        }

        .logo-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .version-badge {
            display: inline-block;
            background: var(--warning-color);
            color: var(--dark-color);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 15px;
            vertical-align: middle;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .formulario-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--secondary-color);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            margin-top: 20px;
            transition: var(--transition);
        }

        .formulario-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        /* NAVEGACIÓN */
        .nav-tabs {
            display: flex;
            background: white;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        .nav-tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: var(--gray-color);
        }

        .nav-tab:hover {
            background: var(--light-color);
            color: var(--primary-color);
        }

        .nav-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: var(--light-color);
        }

        .tab-icon {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        /* CONTENIDO DE TABS */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* FLUJO DE PROCESOS */
        .process-flow {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .flow-timeline {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
        }

        .flow-timeline::before {
            content: '';
            position: absolute;
            left: 60px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--primary-color), var(--info-color));
            border-radius: 3px;
        }

        .flow-step {
            display: flex;
            margin-bottom: 40px;
            position: relative;
        }

        .step-marker {
            flex-shrink: 0;
            width: 120px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 700;
            box-shadow: 0 5px 20px rgba(0, 86, 163, 0.3);
            z-index: 1;
            border: 4px solid white;
        }

        .step-content {
            flex: 1;
            margin-left: 40px;
            background: var(--light-color);
            padding: 30px;
            border-radius: var(--border-radius);
            border: 1px solid rgba(0, 86, 163, 0.1);
            transition: var(--transition);
        }

        .step-content:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 86, 163, 0.1);
        }

        .step-title {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-size: 1.4rem;
            font-weight: 600;
        }

        .step-icon {
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .step-description {
            color: var(--gray-color);
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .step-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .detail-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary-color);
        }

        .detail-title {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-list {
            list-style: none;
            padding: 0;
        }

        .detail-list li {
            padding: 5px 0;
            color: var(--gray-color);
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }

        .detail-list li i {
            color: var(--secondary-color);
            margin-top: 5px;
        }

        /* SECCIÓN DE ERRORES */
        .errors-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            box-shadow: var(--box-shadow);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-color);
        }

        .section-title {
            font-size: 2rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .download-all-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--primary-color);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: var(--transition);
            border: none;
            cursor: pointer;
        }

        .download-all-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 86, 163, 0.3);
        }

        /* CATEGORÍAS DE ERRORES */
        .error-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .error-category {
            background: var(--light-color);
            border-radius: var(--border-radius);
            padding: 25px;
            border-left: 4px solid var(--danger-color);
            transition: var(--transition);
            cursor: pointer;
        }

        .error-category:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.1);
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .category-icon {
            width: 50px;
            height: 50px;
            background: var(--danger-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .category-title {
            font-size: 1.4rem;
            color: var(--dark-color);
            margin: 0;
        }

        .error-count {
            display: inline-block;
            background: var(--danger-color);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .error-list {
            list-style: none;
            padding: 0;
        }

        .error-item {
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .error-item:last-child {
            border-bottom: none;
        }

        .error-info {
            flex: 1;
        }

        .error-code {
            font-weight: 600;
            color: var(--danger-color);
            margin-right: 10px;
        }

        .error-desc {
            color: var(--gray-color);
            font-size: 0.95rem;
            margin-top: 3px;
        }

        .download-error-btn {
            background: var(--warning-color);
            color: var(--dark-color);
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .download-error-btn:hover {
            background: #e0a800;
        }

        /* TABLA DE ERRORES DETALLADA */
        .errors-table-container {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-top: 40px;
            max-height: 600px;
            overflow-y: auto;
        }

        .errors-table {
            width: 100%;
            border-collapse: collapse;
        }

        .errors-table th {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .errors-table td {
            padding: 15px;
            border-bottom: 1px solid #eaeaea;
            vertical-align: top;
        }

        .errors-table tr:nth-child(even) {
            background: rgba(0, 86, 163, 0.02);
        }

        .errors-table tr:hover {
            background: rgba(0, 86, 163, 0.05);
        }

        .severity-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .severity-high {
            background: #dc3545;
            color: white;
        }

        .severity-medium {
            background: #ffc107;
            color: var(--dark-color);
        }

        .severity-low {
            background: #17a2b8;
            color: white;
        }

        /* SOLUCIÓN PASO A PASO */
        .solution-steps {
            background: #f0fff4;
            border-left: 4px solid var(--secondary-color);
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin-top: 10px;
        }

        .solution-steps ol {
            margin-left: 20px;
        }

        .solution-steps li {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        /* NUEVA SECCIÓN: VALIDACIONES COMPLETAS */
        .validations-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .validation-category {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border-top: 4px solid var(--primary-color);
        }

        .validation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .validation-header i {
            font-size: 1.8rem;
        }

        .validation-list {
            list-style: none;
            padding: 0;
        }

        .validation-item {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .validation-item:last-child {
            border-bottom: none;
        }

        .validation-item i {
            color: var(--secondary-color);
            margin-top: 3px;
            flex-shrink: 0;
        }

        /* SECCIÓN ESTRUCTURA COLUMNAS */
        .columns-section {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 30px;
            margin-top: 30px;
        }

        .columns-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .column-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--info-color);
        }

        .column-number {
            display: inline-block;
            background: var(--info-color);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }

        /* ESTADÍSTICAS */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .stat-card {
            text-align: center;
            padding: 25px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 86, 163, 0.1);
        }

        .stat-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .stat-number {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.95rem;
            color: var(--gray-color);
            font-weight: 500;
        }

        /* FOOTER */
        .footer {
            background: var(--primary-dark);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: var(--border-radius);
            margin-top: 30px;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .footer-logo i {
            font-size: 2rem;
            opacity: 0.8;
        }

        .footer-text {
            opacity: 0.8;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        /* RESPONSIVE */
        @media (max-width: 1024px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .logo {
                width: 60px;
                height: 60px;
                font-size: 2rem;
            }
            
            .flow-timeline::before {
                left: 45px;
            }
            
            .step-marker {
                width: 90px;
                height: 45px;
                font-size: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .flow-timeline::before {
                display: none;
            }
            
            .flow-step {
                flex-direction: column;
                gap: 15px;
            }
            
            .step-marker {
                align-self: center;
            }
            
            .step-content {
                margin-left: 0;
            }
            
            .section-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .error-categories,
            .validations-container {
                grid-template-columns: 1fr;
            }
            
            .errors-table {
                display: block;
                overflow-x: auto;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .version-badge {
                display: block;
                margin: 10px auto 0;
                width: fit-content;
            }
            
            .step-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="logo-title">
                <div class="logo">
                    <i class="fas fa-syringe"></i>
                </div>
                <div>
                    <h1>Sistema Vacunas PAI <span class="version-badge">v4.0 - 15 Columnas</span></h1>
                    <p class="subtitle">Flujo automatizado de validación y consolidación</p>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfjzvdhv3kIhkMLyrGfpUwFRkPLpVyOVyu0dMEB7m9crK9JTA/viewform?usp=dialog" target="_blank" class="formulario-btn">
                        <i class="fas fa-file-upload"></i>
                        Ir al Formulario de Cargue
                    </a>
                </div>
            </div>
        </div>

        <!-- NAVEGACIÓN POR TABS -->
        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="flujo">
                <i class="fas fa-project-diagram tab-icon"></i>
                Flujo del Proceso
            </div>
            <div class="nav-tab" data-tab="validaciones">
                <i class="fas fa-check-circle tab-icon"></i>
                Validaciones Completas
            </div>
            <div class="nav-tab" data-tab="estructura">
                <i class="fas fa-table tab-icon"></i>
                Estructura 15 Columnas
            </div>
            <div class="nav-tab" data-tab="errores">
                <i class="fas fa-exclamation-triangle tab-icon"></i>
                Errores Comunes
            </div>
            <div class="nav-tab" data-tab="estadisticas">
                <i class="fas fa-chart-bar tab-icon"></i>
                Estadísticas
            </div>
        </div>

        <!-- TAB 1: FLUJO DEL PROCESO -->
        <div id="flujo" class="tab-content active">
            <div class="process-flow">
                <h2 class="section-title" style="color: var(--primary-color); margin-bottom: 30px;">
                    <i class="fas fa-project-diagram"></i>
                    Flujo Completo del Sistema
                </h2>
                
                <div class="flow-timeline">
                    <!-- PASO 1 -->
                    <div class="flow-step">
                        <div class="step-marker">01</div>
                        <div class="step-content">
                            <div class="step-title">
                                <i class="fas fa-file-upload step-icon"></i>
                                Envío del Formulario
                            </div>
                            <p class="step-description">El usuario completa el formulario de Google con datos básicos y URL del archivo Drive.</p>
                            
                            <div class="step-details">
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-check-circle"></i>
                                        Validaciones Iniciales
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-check"></i> Correo electrónico válido</li>
                                        <li><i class="fas fa-check"></i> URL de Drive válida</li>
                                        <li><i class="fas fa-check"></i> Campos obligatorios completos</li>
                                    </ul>
                                </div>
                                
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-id-card"></i>
                                        Identificación
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-hashtag"></i> ID único generado: VACPAI-XXXXX</li>
                                        <li><i class="fas fa-calendar"></i> Timestamp automático</li>
                                        <li><i class="fas fa-user"></i> Responsable registrado</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PASO 2 -->
                    <div class="flow-step">
                        <div class="step-marker">02</div>
                        <div class="step-content">
                            <div class="step-title">
                                <i class="fas fa-clipboard-check step-icon"></i>
                                Validación de Estructura
                            </div>
                            <p class="step-description">Verificación estricta del archivo Excel/Google Sheets.</p>
                            
                            <div class="step-details">
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-file-excel"></i>
                                        Requisitos del Archivo
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-check"></i> Hoja "Detalle" (EXACTO)</li>
                                        <li><i class="fas fa-check"></i> 15 columnas exactamente</li>
                                        <li><i class="fas fa-check"></i> Encabezados idénticos</li>
                                        <li><i class="fas fa-check"></i> Al menos un registro</li>
                                    </ul>
                                </div>
                                
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-times-circle"></i>
                                        Rechazo Inmediato Si
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-times"></i> Archivo vacío</li>
                                        <li><i class="fas fa-times"></i> Estructura incorrecta</li>
                                        <li><i class="fas fa-times"></i> Hoja no encontrada</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PASO 3 -->
                    <div class="flow-step">
                        <div class="step-marker">03</div>
                        <div class="step-content">
                            <div class="step-title">
                                <i class="fas fa-search step-icon"></i>
                                Validación de Contenido
                            </div>
                            <p class="step-description">Validación detallada de cada registro individual.</p>
                            
                            <div class="step-details">
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-calendar-alt"></i>
                                        Validación de Fechas
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-check"></i> Formato DD/MM/YYYY</li>
                                        <li><i class="fas fa-check"></i> Rango: 01/01/2025 - Hoy</li>
                                        <li><i class="fas fa-check"></i> No fechas futuras</li>
                                        <li><i class="fas fa-check"></i> Fechas válidas</li>
                                    </ul>
                                </div>
                                
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-clone"></i>
                                        Validación de Duplicidad
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-check"></i> Duplicidad interna</li>
                                        <li><i class="fas fa-check"></i> Duplicidad histórica</li>
                                        <li><i class="fas fa-check"></i> Tipo ID + Documento + Fecha</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PASO 4 -->
                    <div class="flow-step">
                        <div class="step-marker">04</div>
                        <div class="step-content">
                            <div class="step-title">
                                <i class="fas fa-envelope step-icon"></i>
                                Notificación Automática
                            </div>
                            <p class="step-description">Comunicación inmediata del resultado al usuario.</p>
                            
                            <div class="step-details">
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                                        Recepción Exitosa
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-envelope"></i> Correo de confirmación</li>
                                        <li><i class="fas fa-id-card"></i> ID del cargue</li>
                                        <li><i class="fas fa-file-alt"></i> Resumen de registros</li>
                                        <li><i class="fas fa-calendar"></i> Fecha y hora</li>
                                    </ul>
                                </div>
                                
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-times-circle" style="color: #dc3545;"></i>
                                        Rechazo con Detalles
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-file-csv"></i> CSV con errores detallados</li>
                                        <li><i class="fas fa-list"></i> Lista específica de errores</li>
                                        <li><i class="fas fa-lightbulb"></i> Soluciones sugeridas</li>
                                        <li><i class="fas fa-redo"></i> Instrucciones para reenvío</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PASO 5 -->
                    <div class="flow-step">
                        <div class="step-marker">05</div>
                        <div class="step-content">
                            <div class="step-title">
                                <i class="fas fa-sync-alt step-icon"></i>
                                Consolidación Automática
                            </div>
                            <p class="step-description">Procesamiento periódico de archivos recepcionados.</p>
                            
                            <div class="step-details">
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-clock"></i>
                                        Programación
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-sync"></i> Ejecución cada 5 minutos</li>
                                        <li><i class="fas fa-check"></i> Solo archivos "RECEPCIONADOS"</li>
                                        <li><i class="fas fa-database"></i> Extracción automática de datos</li>
                                    </ul>
                                </div>
                                
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-file-export"></i>
                                        Conversión
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-file-excel"></i> Excel → Google Sheets</li>
                                        <li><i class="fas fa-check-double"></i> Validación de datos</li>
                                        <li><i class="fas fa-save"></i> Almacenamiento en histórico</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PASO 6 -->
                    <div class="flow-step">
                        <div class="step-marker">06</div>
                        <div class="step-content">
                            <div class="step-title">
                                <i class="fas fa-database step-icon"></i>
                                Base de Datos Central
                            </div>
                            <p class="step-description">Almacenamiento unificado en hoja consolidada.</p>
                            
                            <div class="step-details">
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-table"></i>
                                        Estructura Consolidada
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-file-alt"></i> Hoja "CONSOLIDADO_BD"</li>
                                        <li><i class="fas fa-history"></i> Datos históricos</li>
                                        <li><i class="fas fa-tag"></i> ID de origen</li>
                                        <li><i class="fas fa-calendar"></i> Fecha de consolidación</li>
                                    </ul>
                                </div>
                                
                                <div class="detail-card">
                                    <div class="detail-title">
                                        <i class="fas fa-chart-line"></i>
                                        Disponibilidad
                                    </div>
                                    <ul class="detail-list">
                                        <li><i class="fas fa-check"></i> Datos para análisis</li>
                                        <li><i class="fas fa-search"></i> Consultas disponibles</li>
                                        <li><i class="fas fa-download"></i> Exportación habilitada</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: VALIDACIONES COMPLETAS -->
        <div id="validaciones" class="tab-content">
            <div class="errors-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-check-circle"></i>
                        Validaciones Completas del Sistema
                    </h2>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfjzvdhv3kIhkMLyrGfpUwFRkPLpVyOVyu0dMEB7m9crK9JTA/viewform?usp=dialog" target="_blank" class="download-all-btn">
                        <i class="fas fa-file-upload"></i> Ir al Formulario
                    </a>
                </div>
                
                <div class="validations-container">
                    <!-- VALIDACIONES DE ESTRUCTURA -->
                    <div class="validation-category">
                        <div class="validation-header">
                            <i class="fas fa-file-excel"></i>
                            <h3>Validaciones de Estructura</h3>
                        </div>
                        <ul class="validation-list">
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Hoja llamada EXACTAMENTE "Detalle" (case sensitive)</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>15 columnas exactamente (ni más, ni menos)</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Encabezados idénticos a los requeridos</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Al menos un registro de datos (no vacío)</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Formato Excel (.xlsx, .xls) o Google Sheets</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Tamaño máximo: 100 MB</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- VALIDACIONES DE DATOS -->
                    <div class="validation-category">
                        <div class="validation-header">
                            <i class="fas fa-database"></i>
                            <h3>Validaciones de Datos</h3>
                        </div>
                        <ul class="validation-list">
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Fecha aplicación en formato DD/MM/YYYY</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Rango de fechas: 01/01/2025 hasta hoy</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>No se permiten fechas futuras</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Sede debe estar en lista de 39 sedes válidas</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Modalidad: "Intramural" o "Extramural" exactamente</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Tipo ID debe estar en lista de 12 tipos válidos</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- VALIDACIONES DE CONTENIDO -->
                    <div class="validation-category">
                        <div class="validation-header">
                            <i class="fas fa-clipboard-check"></i>
                            <h3>Validaciones de Contenido</h3>
                        </div>
                        <ul class="validation-list">
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Número de documento sin caracteres especiales (, . ; -)</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Documento mínimo 3 caracteres</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>EPS Sanitas: Solo "Si" o "No"</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Al menos un biológico aplicado (1-8)</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Biológicos deben estar en lista permitida (20 tipos)</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>No biológicos duplicados en misma fila</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- VALIDACIONES DE DUPLICIDAD -->
                    <div class="validation-category">
                        <div class="validation-header">
                            <i class="fas fa-copy"></i>
                            <h3>Validaciones de Duplicidad</h3>
                        </div>
                        <ul class="validation-list">
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Duplicidad interna en el mismo archivo</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Duplicidad contra base de datos histórica</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Clave única: Tipo ID + Documento + Fecha</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Validación cruzada con hoja CONSOLIDADO_BD</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- VALIDACIONES NUEVAS COLUMNAS -->
                    <div class="validation-category">
                        <div class="validation-header">
                            <i class="fas fa-columns"></i>
                            <h3>Validaciones Nuevas Columnas</h3>
                        </div>
                        <ul class="validation-list">
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Biológico aplicado 7 y 8 (nuevas columnas M, N)</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Responsable vacuna (columna O) obligatorio</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Responsable: Solo letras y espacios</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Responsable mínimo 3 caracteres</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Responsable debe incluir nombre y apellido</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- VALIDACIONES DE FORMULARIO -->
                    <div class="validation-category">
                        <div class="validation-header">
                            <i class="fas fa-file-signature"></i>
                            <h3>Validaciones de Formulario</h3>
                        </div>
                        <ul class="validation-list">
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Correo electrónico válido y obligatorio</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>URL de Google Drive válida</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Archivo accesible y con permisos de lectura</span>
                            </li>
                            <li class="validation-item">
                                <i class="fas fa-check"></i>
                                <span>Generación automática de ID único (VACPAI-XXXXX)</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <!-- LISTAS DE VALORES PERMITIDOS -->
                <div class="columns-section">
                    <h3 style="color: var(--primary-color); margin-bottom: 20px;">
                        <i class="fas fa-list-check"></i>
                        Listas de Valores Permitidos
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div>
                            <h4 style="color: var(--danger-color); margin-bottom: 10px;">🏥 SEDES VÁLIDAS (39)</h4>
                            <ul style="font-size: 0.9rem; color: var(--gray-color); max-height: 200px; overflow-y: auto; padding-left: 20px;">
                                <li>CM Calle 80 Piso 4</li>
                                <li>CM Bucaramanga Sotomayor</li>
                                <li>CM Suba Al Paso</li>
                                <li>CM Nariño</li>
                                <li>CM Teusaquillo</li>
                                <li>CM Kennedy Bomberos</li>
                                <li>CM Cucuta Eps Sanitas</li>
                                <li>CM Ibague Altamaria</li>
                                <li>CM Versalles Norte</li>
                                <li>CM Nuevo Horizonte</li>
                                <li>Central De Urgencias Norte</li>
                                <li>CM Plaza De Las Americas</li>
                                <li>CM Soacha</li>
                                <li>CM Cra 43</li>
                                <li>CM Medellin</li>
                                <li>CM Santa Marta Jardin</li>
                                <li>CM Neiva</li>
                                <li>CM Armenia Fundadores</li>
                                <li>CM Tunal</li>
                                <li>CM Chia</li>
                                <li>CM Popayan Norte</li>
                                <li>CM Fontibon</li>
                                <li>CM Pie De La Popa</li>
                                <li>CM Prados Del Norte</li>
                                <li>CM Avenida Universitaria</li>
                                <li>CM Valledupar Las Flores</li>
                                <li>CM Chico Navarra</li>
                                <li>CM Avenida Santander</li>
                                <li>CM Palmira</li>
                                <li>CM Calle 30</li>
                                <li>CM Restrepo</li>
                                <li>CM Floridablanca</li>
                                <li>CM Cra 36</li>
                                <li>CM Monteria Nuestro</li>
                                <li>CM Murillo</li>
                                <li>CM Flora Industrial</li>
                                <li>CM Santa Clara Eps Sanitas</li>
                                <li>CM Girardot Unicentro</li>
                                <li>CM Providencia</li>
                                <li>CM Tunja La Maria</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h4 style="color: var(--info-color); margin-bottom: 10px;">💉 BIOLÓGICOS VÁLIDOS (20)</h4>
                            <ul style="font-size: 0.9rem; color: var(--gray-color); max-height: 200px; overflow-y: auto; padding-left: 20px;">
                                <li>TUBERCULOSIS BCG</li>
                                <li>INFLUENZA TIPO B</li>
                                <li>NEUMOCOCO</li>
                                <li>TETANOS Y DIFTERIA [TD]</li>
                                <li>DIFTERIA, TETANOS Y TOS FERINA [DPT]</li>
                                <li>PENTAVALENTE</li>
                                <li>POLIOMIELITIS (VOP O IVP)</li>
                                <li>HEPATITIS A</li>
                                <li>HEPATITIS B</li>
                                <li>FIEBRE AMARILLA</li>
                                <li>RABIA</li>
                                <li>VARICELA</li>
                                <li>INFLUENZA</li>
                                <li>ROTAVIRUS</li>
                                <li>VPH (VIRUS PAPILOMA HUMANO)</li>
                                <li>TRIPLE VIRAL (SARAMPION, PAROTIDITIS Y RUBEOLA)</li>
                                <li>COVID-19</li>
                                <li>DOBLE VIRAL (SARAMPION Y RUBEOLA)</li>
                                <li>HEXAVALENTE</li>
                                <li>OTRA VACUNACION DEL PAI</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h4 style="color: var(--warning-color); margin-bottom: 10px;">🆔 TIPOS DE IDENTIFICACIÓN (12)</h4>
                            <ul style="font-size: 0.9rem; color: var(--gray-color); max-height: 200px; overflow-y: auto; padding-left: 20px;">
                                <li>RC: Registro Civil</li>
                                <li>CC: Cédula de ciudadania</li>
                                <li>TI: Tarjeta de identidad</li>
                                <li>CE: Cédula de extranjeria</li>
                                <li>PA: Pasaporte</li>
                                <li>CN: Certificado Nacido Vivo</li>
                                <li>CD: Carné diplomatico</li>
                                <li>SC: Salvoconducto de permanencia</li>
                                <li>PE: Permiso especial de permanencia</li>
                                <li>PT: Permiso temporal de permanencia</li>
                                <li>AS: Adulto sin identificar</li>
                                <li>MS: Menor sin identificar</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: ESTRUCTURA 15 COLUMNAS -->
        <div id="estructura" class="tab-content">
            <div class="errors-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-table"></i>
                        Estructura de 15 Columnas Requerida
                    </h2>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfjzvdhv3kIhkMLyrGfpUwFRkPLpVyOVyu0dMEB7m9crK9JTA/viewform?usp=dialog" target="_blank" class="download-all-btn">
                        <i class="fas fa-file-upload"></i> Cargar Archivo
                    </a>
                </div>
                
                <div class="columns-section">
                    <p style="margin-bottom: 20px; font-size: 1.1rem;">
                        El archivo debe tener EXACTAMENTE 15 columnas con los siguientes encabezados (respetando mayúsculas, minúsculas y espacios):
                    </p>
                    
                    <div class="columns-grid">
                        <div class="column-card">
                            <div class="column-number">1</div>
                            <strong>SEDE</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Debe ser una de las 39 sedes válidas
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">2</div>
                            <strong>Fecha aplicación</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Formato DD/MM/YYYY, rango 01/01/2025 - hoy
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">3</div>
                            <strong>Modalidad de aplicación</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                "Intramural" o "Extramural" exactamente
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">4</div>
                            <strong>Tipo Id</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Uno de los 12 tipos de identificación válidos
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">5</div>
                            <strong>Número de Identificación (sin caracteres especiales como comas, puntos, etc)</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Sin , . ; -, mínimo 3 caracteres
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">6</div>
                            <strong>El usuario tiene EPS Sanitas?</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Solo "Si" o "No"
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">7</div>
                            <strong>Biologico aplicado 1</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Uno de los 20 biológicos válidos
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">8</div>
                            <strong>Biologico aplicado 2</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Opcional, pero debe ser válido si se llena
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">9</div>
                            <strong>Biologico aplicado 3</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Opcional, pero debe ser válido si se llena
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">10</div>
                            <strong>Biologico aplicado 4</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Opcional, pero debe ser válido si se llena
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">11</div>
                            <strong>Biologico aplicado 5</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Opcional, pero debe ser válido si se llena
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">12</div>
                            <strong>Biologico aplicado 6</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Opcional, pero debe ser válido si se llena
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">13</div>
                            <strong>Biologico aplicado 7</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Nueva columna, válido si se llena
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">14</div>
                            <strong>Biologico aplicado 8</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Nueva columna, válido si se llena
                            </div>
                        </div>
                        
                        <div class="column-card">
                            <div class="column-number">15</div>
                            <strong>Responsable vacuna (Nombre quien registra)</strong>
                            <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 5px;">
                                Nombre completo, solo letras y espacios
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #e7f3ff; border-radius: var(--border-radius);">
                        <h4 style="color: var(--primary-color); margin-bottom: 10px;">
                            <i class="fas fa-lightbulb"></i>
                            Importante sobre los encabezados
                        </h4>
                        <ul style="margin: 0; padding-left: 20px; color: var(--gray-color);">
                            <li>Los encabezados deben ser <strong>EXACTAMENTE</strong> iguales (respetar mayúsculas, minúsculas, espacios y puntuación)</li>
                            <li>La hoja debe llamarse <strong>EXACTAMENTE "Detalle"</strong> (no "detalle", "DETALLE" o "Detalles")</li>
                            <li>Debe haber <strong>15 columnas exactamente</strong> (ni una más, ni una menos)</li>
                            <li>El orden de las columnas <strong>no puede modificarse</strong></li>
                            <li>Se requiere al menos <strong>un registro de datos</strong> después de los encabezados</li>
                        </ul>
                    </div>
                </div>
                
                <div style="margin-top: 30px; text-align: center;">
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfjzvdhv3kIhkMLyrGfpUwFRkPLpVyOVyu0dMEB7m9crK9JTA/viewform?usp=dialog" target="_blank" class="formulario-btn" style="display: inline-flex; margin-top: 0;">
                        <i class="fas fa-file-upload"></i>
                        Ir al Formulario para Cargar Archivo
                    </a>
                </div>
            </div>
        </div>

        <!-- TAB 4: ERRORES COMUNES -->
        <div id="errores" class="tab-content">
            <div class="errors-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        Errores Comunes y Soluciones
                    </h2>
                    <button class="download-all-btn" onclick="downloadAllErrorsCSV()">
                        <i class="fas fa-download"></i> Descargar Todos los Errores (CSV)
                    </button>
                </div>
                
                <!-- CATEGORÍAS DE ERRORES -->
                <div class="error-categories">
                    <!-- CATEGORÍA 1 -->
                    <div class="error-category" onclick="showErrorCategory('estructura')">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-file-excel"></i>
                            </div>
                            <h3 class="category-title">
                                Estructura del Archivo
                                <span class="error-count">3 errores</span>
                            </h3>
                        </div>
                        <ul class="error-list">
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-001</div>
                                    <div class="error-desc">Hoja "Detalle" no encontrada</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-001')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-002</div>
                                    <div class="error-desc">15 columnas requeridas</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-002')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-003</div>
                                    <div class="error-desc">Encabezados incorrectos</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-003')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- CATEGORÍA 2 -->
                    <div class="error-category" onclick="showErrorCategory('datos')">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-database"></i>
                            </div>
                            <h3 class="category-title">
                                Validación de Datos
                                <span class="error-count">4 errores</span>
                            </h3>
                        </div>
                        <ul class="error-list">
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-004</div>
                                    <div class="error-desc">Fecha fuera de rango</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-004')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-005</div>
                                    <div class="error-desc">Sede no válida</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-005')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-006</div>
                                    <div class="error-desc">Documento con caracteres especiales</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-006')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-010</div>
                                    <div class="error-desc">Sin biológico aplicado</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-010')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- CATEGORÍA 3 -->
                    <div class="error-category" onclick="showErrorCategory('duplicidad')">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-copy"></i>
                            </div>
                            <h3 class="category-title">
                                Duplicidad
                                <span class="error-count">2 errores</span>
                            </h3>
                        </div>
                        <ul class="error-list">
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-007</div>
                                    <div class="error-desc">Duplicidad interna en archivo</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-007')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-008</div>
                                    <div class="error-desc">Duplicidad con histórico</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-008')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- CATEGORÍA 4 -->
                    <div class="error-category" onclick="showErrorCategory('contenido')">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3 class="category-title">
                                Contenido Específico
                                <span class="error-count">2 errores</span>
                            </h3>
                        </div>
                        <ul class="error-list">
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-009</div>
                                    <div class="error-desc">Modalidad no válida</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-009')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                            <li class="error-item">
                                <div class="error-info">
                                    <div class="error-code">ERR-011</div>
                                    <div class="error-desc">Responsable vacuna inválido</div>
                                </div>
                                <button class="download-error-btn" onclick="downloadErrorCSV('ERR-011')">
                                    <i class="fas fa-download"></i> CSV
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- TABLA DETALLADA DE ERRORES -->
                <div class="errors-table-container">
                    <table class="errors-table">
                        <thead>
                            <tr>
                                <th>Código</th>
                                <th>Error</th>
                                <th>Severidad</th>
                                <th>Descripción</th>
                                <th>Solución</th>
                                <th>Descargar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- ERR-001 -->
                            <tr>
                                <td><strong>ERR-001</strong></td>
                                <td>Hoja "Detalle" no encontrada</td>
                                <td><span class="severity-badge severity-high">ALTA</span></td>
                                <td>El archivo no contiene una hoja llamada EXACTAMENTE "Detalle"</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Verificar nombre exacto "Detalle"</li>
                                            <li>Corregir mayúsculas/minúsculas</li>
                                            <li>No usar espacios extras</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-001')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-002 -->
                            <tr>
                                <td><strong>ERR-002</strong></td>
                                <td>15 columnas requeridas</td>
                                <td><span class="severity-badge severity-high">ALTA</span></td>
                                <td>Se esperan 15 columnas exactamente</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Verificar que haya 15 columnas</li>
                                            <li>No eliminar columnas vacías</li>
                                            <li>No agregar columnas adicionales</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-002')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-003 -->
                            <tr>
                                <td><strong>ERR-003</strong></td>
                                <td>Encabezados incorrectos</td>
                                <td><span class="severity-badge severity-high">ALTA</span></td>
                                <td>Los nombres de las columnas no coinciden exactamente</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Copiar y pegar encabezados exactos</li>
                                            <li>Verificar mayúsculas y espacios</li>
                                            <li>Usar plantilla como referencia</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-003')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-004 -->
                            <tr>
                                <td><strong>ERR-004</strong></td>
                                <td>Fecha fuera de rango</td>
                                <td><span class="severity-badge severity-high">ALTA</span></td>
                                <td>Fecha anterior al 01/01/2025 o posterior a hoy</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Usar fechas entre 01/01/2025 y hoy</li>
                                            <li>Formato DD/MM/YYYY</li>
                                            <li>No usar fechas futuras</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-004')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-005 -->
                            <tr>
                                <td><strong>ERR-005</strong></td>
                                <td>Sede no válida</td>
                                <td><span class="severity-badge severity-medium">MEDIA</span></td>
                                <td>La sede no se encuentra en la lista de sedes permitidas</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Usar exactamente uno de los nombres de sede permitidos</li>
                                            <li>Verificar mayúsculas y espacios</li>
                                            <li>Consultar lista completa de sedes</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-005')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-006 -->
                            <tr>
                                <td><strong>ERR-006</strong></td>
                                <td>Documento con caracteres especiales</td>
                                <td><span class="severity-badge severity-medium">MEDIA</span></td>
                                <td>Número de identificación contiene , . ; -</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Eliminar caracteres especiales</li>
                                            <li>Usar solo números y letras</li>
                                            <li>Mínimo 3 caracteres</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-006')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-007 -->
                            <tr>
                                <td><strong>ERR-007</strong></td>
                                <td>Duplicidad interna en archivo</td>
                                <td><span class="severity-badge severity-high">ALTA</span></td>
                                <td>Misma persona aparece más de una vez en el mismo archivo</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Identificar filas duplicadas</li>
                                            <li>Eliminar registros duplicados manteniendo solo uno</li>
                                            <li>Verificar combinaciones únicas (Tipo ID + Documento + Fecha)</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-007')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-008 -->
                            <tr>
                                <td><strong>ERR-008</strong></td>
                                <td>Duplicidad con histórico</td>
                                <td><span class="severity-badge severity-high">ALTA</span></td>
                                <td>Persona ya fue registrada en cargues anteriores</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Descargar CSV de duplicados del correo</li>
                                            <li>Eliminar del archivo las personas ya registradas</li>
                                            <li>Conservar solo registros nuevos</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-008')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-009 -->
                            <tr>
                                <td><strong>ERR-009</strong></td>
                                <td>Modalidad no válida</td>
                                <td><span class="severity-badge severity-medium">MEDIA</span></td>
                                <td>Debe ser "Intramural" o "Extramural" exactamente</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Usar EXACTAMENTE: "Intramural" o "Extramural"</li>
                                            <li>No usar abreviaciones: "Intra", "Extra"</li>
                                            <li>Verificar mayúscula inicial</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-009')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-010 -->
                            <tr>
                                <td><strong>ERR-010</strong></td>
                                <td>Sin biológico aplicado</td>
                                <td><span class="severity-badge severity-high">ALTA</span></td>
                                <td>Debe registrar al menos un biológico aplicado</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Completar al menos "Biologico aplicado 1"</li>
                                            <li>Usar nombres exactos de lista permitida</li>
                                            <li>No duplicar biológicos en misma fila</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-010')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                            
                            <!-- ERR-011 -->
                            <tr>
                                <td><strong>ERR-011</strong></td>
                                <td>Responsable vacuna inválido</td>
                                <td><span class="severity-badge severity-medium">MEDIA</span></td>
                                <td>Nombre incompleto o con caracteres no permitidos</td>
                                <td>
                                    <div class="solution-steps">
                                        <ol>
                                            <li>Escribir nombre COMPLETO (nombre y apellido)</li>
                                            <li>Usar solo letras y espacios</li>
                                            <li>Mínimo 3 caracteres</li>
                                            <li>Incluir al menos un espacio entre nombre y apellido</li>
                                        </ol>
                                    </div>
                                </td>
                                <td>
                                    <button class="download-error-btn" onclick="downloadErrorCSV('ERR-011')">
                                        <i class="fas fa-download"></i> CSV
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- CONSEJOS RÁPIDOS -->
                <div style="margin-top: 40px; padding: 25px; background: #e7f3ff; border-radius: var(--border-radius);">
                    <h3 style="color: var(--primary-color); margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-lightbulb"></i>
                        Consejos Rápidos para Evitar Errores
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>📋 Antes de enviar:</strong> Verifique los 15 encabezados exactos
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>📅 Fechas:</strong> Use siempre DD/MM/YYYY, no otros formatos
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>🔍 Duplicados:</strong> Use "Buscar duplicados" en Excel primero
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>✅ Validación:</strong> Revise que todos los campos obligatorios estén completos
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>🏥 Sede:</strong> Copie y pegue el nombre exacto de la lista
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>💉 Biológicos:</strong> Al menos uno debe estar diligenciado
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; text-align: center;">
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfjzvdhv3kIhkMLyrGfpUwFRkPLpVyOVyu0dMEB7m9crK9JTA/viewform?usp=dialog" target="_blank" class="formulario-btn" style="display: inline-flex; margin-top: 0;">
                        <i class="fas fa-file-upload"></i>
                        Probar el Formulario de Cargue
                    </a>
                </div>
            </div>
        </div>

        <!-- TAB 5: ESTADÍSTICAS -->
        <div id="estadisticas" class="tab-content">
            <div class="errors-section">
                <h2 class="section-title" style="margin-bottom: 30px;">
                    <i class="fas fa-chart-bar"></i>
                    Estadísticas del Sistema
                </h2>
                
                <div class="stats-section">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-number">85%</div>
                        <div class="stat-label">Tasa de Recepción</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <div class="stat-number">12%</div>
                        <div class="stat-label">Tasa de Rechazo</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-copy"></i>
                        </div>
                        <div class="stat-number">3%</div>
                        <div class="stat-label">Errores por Duplicidad</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="stat-number">100%</div>
                        <div class="stat-label">Consolidación Automática</div>
                    </div>
                </div>
                
                <!-- DISTRIBUCIÓN DE ERRORES -->
                <div style="margin-top: 40px; background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
                    <h3 style="color: var(--primary-color); margin-bottom: 20px;">Distribución de Errores por Tipo</h3>
                    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                        <div style="flex: 1; min-width: 250px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>Estructura del Archivo</span>
                                <span style="font-weight: 600;">35%</span>
                            </div>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                <div style="width: 35%; height: 100%; background: var(--danger-color);"></div>
                            </div>
                        </div>
                        
                        <div style="flex: 1; min-width: 250px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>Validación de Datos</span>
                                <span style="font-weight: 600;">40%</span>
                            </div>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                <div style="width: 40%; height: 100%; background: var(--warning-color);"></div>
                            </div>
                        </div>
                        
                        <div style="flex: 1; min-width: 250px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>Duplicidad</span>
                                <span style="font-weight: 600;">15%</span>
                            </div>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                <div style="width: 15%; height: 100%; background: var(--info-color);"></div>
                            </div>
                        </div>
                        
                        <div style="flex: 1; min-width: 250px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>Otros Errores</span>
                                <span style="font-weight: 600;">10%</span>
                            </div>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                <div style="width: 10%; height: 100%; background: var(--gray-color);"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- TIEMPOS DE PROCESAMIENTO -->
                <div style="margin-top: 40px; background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
                    <h3 style="color: var(--primary-color); margin-bottom: 20px;">Tiempos de Procesamiento</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">2-3 min</div>
                            <div style="color: var(--gray-color);">Validación inicial</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">5 min</div>
                            <div style="color: var(--gray-color);">Ciclo consolidación</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">Instantáneo</div>
                            <div style="color: var(--gray-color);">Notificación por email</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">24/7</div>
                            <div style="color: var(--gray-color);">Disponibilidad sistema</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 40px; text-align: center; padding: 20px; background: #f8f9fa; border-radius: var(--border-radius);">
                    <p style="margin-bottom: 20px; font-size: 1.1rem;">
                        ¿Listo para cargar sus datos de vacunación?
                    </p>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfjzvdhv3kIhkMLyrGfpUwFRkPLpVyOVyu0dMEB7m9crK9JTA/viewform?usp=dialog" target="_blank" class="formulario-btn" style="display: inline-flex;">
                        <i class="fas fa-file-upload"></i>
                        Acceder al Formulario de Cargue
                    </a>
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-syringe"></i>
                    <h3>Sistema Vacunas PAI v4.0</h3>
                </div>
                
                <p class="footer-text">
                    Sistema automatizado de validación y consolidación de datos de vacunación.<br>
                    Procesamiento en tiempo real con trazabilidad completa.
                </p>
                
                <div style="display: flex; justify-content: center; gap: 30px; margin-top: 20px; flex-wrap: wrap;">
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfjzvdhv3kIhkMLyrGfpUwFRkPLpVyOVyu0dMEB7m9crK9JTA/viewform?usp=dialog" target="_blank" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9rem; display: flex; align-items: center; gap: 5px;">
                        <i class="fas fa-file-upload"></i>
                        <span>Formulario de Cargue</span>
                    </a>
                    <a href="#" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9rem; display: flex; align-items: center; gap: 5px;" onclick="showSupport()">
                        <i class="fas fa-headset"></i>
                        <span>Soporte</span>
                    </a>
                    <a href="#" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9rem; display: flex; align-items: center; gap: 5px;" onclick="showUpdates()">
                        <i class="fas fa-sync-alt"></i>
                        <span>Actualizaciones</span>
                    </a>
                    <a href="#" style="color: rgba(255, 255, 255, 0.7); text-decoration: none; font-size: 0.9rem; display: flex; align-items: center; gap: 5px;" onclick="downloadAllErrorsCSV()">
                        <i class="fas fa-download"></i>
                        <span>Descargar Errores</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sistema de navegación por tabs
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Remover clase active de todos los tabs y contenidos
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Agregar clase active al tab y contenido seleccionado
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Datos de errores en formato CSV
        const errorData = {
            'ERR-001': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-001,Hoja "Detalle" no encontrada,ALTA,El archivo no contiene una hoja llamada EXACTAMENTE "Detalle",Corregir nombre de hoja,1. Verificar nombre exacto "Detalle"\n2. Corregir mayúsculas/minúsculas\n3. No usar espacios extras\n4. Confirmar que no sea "detalle" o "DETALLE"`,
            
            'ERR-002': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-002,15 columnas requeridas,ALTA,Se esperan 15 columnas exactamente,Corregir número de columnas,1. Verificar que haya 15 columnas\n2. No eliminar columnas aunque estén vacías\n3. No agregar columnas adicionales\n4. Usar plantilla oficial como referencia`,
            
            'ERR-003': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-003,Encabezados incorrectos,ALTA,Los nombres de las columnas no coinciden exactamente,Corregir encabezados,1. Copiar y pegar encabezados exactos\n2. Verificar mayúsculas, minúsculas y espacios\n3. No modificar puntuación\n4. Mantener orden original`,
            
            'ERR-004': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-004,Fecha fuera de rango,ALTA,Fecha anterior al 01/01/2025 o posterior a la fecha actual,Corregir fecha,1. Usar fechas entre 01/01/2025 y hoy\n2. Formato DD/MM/YYYY exacto\n3. No usar fechas futuras\n4. Verificar días válidos por mes`,
            
            'ERR-005': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-005,Sede no válida,MEDIA,La sede no se encuentra en la lista de sedes permitidas,Seleccionar sede válida,1. Usar exactamente uno de los nombres de sede permitidos\n2. Verificar mayúsculas y espacios\n3. No usar abreviaciones\n4. Consultar lista completa de sedes`,
            
            'ERR-006': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-006,Documento con caracteres especiales,MEDIA,Número de identificación contiene comas, puntos o punto y coma,Eliminar caracteres especiales,1. Eliminar todos los caracteres especiales: , . ; -\n2. Usar solo números y letras si aplica\n3. Verificar que no tenga espacios extras\n4. Mínimo 3 caracteres de longitud`,
            
            'ERR-007': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-007,Duplicidad interna en el archivo,ALTA,Misma persona aparece más de una vez en el mismo archivo,Eliminar duplicados,1. Identificar filas duplicadas (Tipo ID + Documento + Fecha)\n2. Eliminar registros duplicados manteniendo solo uno\n3. Verificar combinaciones únicas\n4. Usar "Buscar duplicados" en Excel`,
            
            'ERR-008': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-008,Duplicidad con base histórica,ALTA,Persona ya fue registrada en cargues anteriores,Eliminar registros existentes,1. Descargar CSV de duplicados del correo\n2. Eliminar del archivo las personas ya registradas\n3. Conservar solo registros nuevos\n4. Verificar contra histórico antes de enviar`,
            
            'ERR-009': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-009,Modalidad no válida,MEDIA,Debe ser "Intramural" o "Extramural" exactamente,Corregir modalidad,1. Usar EXACTAMENTE: "Intramural" o "Extramural"\n2. No usar abreviaciones: "Intra", "Extra"\n3. Verificar mayúscula inicial\n4. No agregar espacios extras`,
            
            'ERR-010': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-010,Sin biológico aplicado,ALTA,Debe registrar al menos un biológico aplicado,Completar biológico,1. Completar al menos "Biologico aplicado 1"\n2. Usar nombres exactos de lista permitida\n3. No duplicar biológicos en misma fila\n4. Verificar ortografía y mayúsculas`,
            
            'ERR-011': `Código,Error,Severidad,Descripción,Solución,Pasos\nERR-011,Responsable vacuna inválido,MEDIA,Nombre incompleto o con caracteres no permitidos,Corregir nombre responsable,1. Escribir nombre COMPLETO (nombre y apellido)\n2. Usar solo letras y espacios\n3. Mínimo 3 caracteres\n4. Incluir al menos un espacio entre nombre y apellido`
        };

        // Función para descargar CSV de un error específico
        function downloadErrorCSV(errorCode) {
            if (errorData[errorCode]) {
                const csvContent = errorData[errorCode];
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `Error_${errorCode}_Sistema_PAI.csv`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                showNotification(`✅ Descargando CSV para ${errorCode}`);
            }
        }

        // Función para descargar todos los errores en un solo CSV
        function downloadAllErrorsCSV() {
            let allErrorsCSV = 'Código,Error,Severidad,Descripción,Solución,Pasos\n';
            
            // Combinar todos los errores
            Object.keys(errorData).forEach(errorCode => {
                const lines = errorData[errorCode].split('\n');
                // Saltar el encabezado para cada error (ya está incluido)
                if (lines.length > 1) {
                    allErrorsCSV += lines[1] + '\n';
                }
            });
            
            const blob = new Blob([allErrorsCSV], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `Todos_Errores_Sistema_PAI_${new Date().getTime()}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('✅ Descargando CSV con todos los errores');
        }

        // Función para mostrar detalles de categoría de error
        function showErrorCategory(category) {
            const categories = {
                'estructura': 'Estructura del Archivo',
                'datos': 'Validación de Datos',
                'duplicidad': 'Duplicidad',
                'contenido': 'Contenido Específico'
            };
            
            showNotification(`Mostrando errores de: ${categories[category]}`);
        }

        // Función para mostrar notificaciones
        function showNotification(message) {
            // Crear elemento de notificación
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary-color);
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                display: flex;
                align-items: center;
                gap: 10px;
            `;
            
            notification.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Remover después de 3 segundos
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Agregar estilos para animaciones de notificación
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Funciones de información
        function showSupport() {
            alert('🆘 Soporte Técnico:\n\n• Email: jsuaza@colsanitas.com\n• Teléfono: +57 302 469 2588\n• Horario: L-V 7am-5pm\n• Respuesta en menos de 24 horas');
        }

        function showUpdates() {
            alert('📅 Últimas actualizaciones:\n\n• Versión 4.0: Ampliación a 15 columnas\n• Nuevas validaciones de duplicidad\n• Mejoras en mensajes de error\n• Sistema de notificación optimizado\n• Validación contra base histórica');
        }

        // Animaciones al cargar
        document.addEventListener('DOMContentLoaded', function() {
            // Animar pasos del flujo
            const flowSteps = document.querySelectorAll('.flow-step');
            flowSteps.forEach((step, index) => {
                step.style.opacity = '0';
                step.style.transform = 'translateX(-20px)';
                step.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                
                setTimeout(() => {
                    step.style.opacity = '1';
                    step.style.transform = 'translateX(0)';
                }, 100 * index);
            });
            
            // Animar tarjetas de categorías de error
            const errorCategories = document.querySelectorAll('.error-category');
            errorCategories.forEach((category, index) => {
                category.style.opacity = '0';
                category.style.transform = 'translateY(20px)';
                category.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                
                setTimeout(() => {
                    category.style.opacity = '1';
                    category.style.transform = 'translateY(0)';
                }, 100 * index);
            });
            
            // Animar validaciones
            const validationCategories = document.querySelectorAll('.validation-category');
            validationCategories.forEach((category, index) => {
                category.style.opacity = '0';
                category.style.transform = 'translateY(20px)';
                category.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                
                setTimeout(() => {
                    category.style.opacity = '1';
                    category.style.transform = 'translateY(0)';
                }, 100 * (index + errorCategories.length));
            });
        });
    </script>
</body>
</html>

